"""Looks up Variables off the online MEPS database

author: chris @ sihrc
"""

import config
from bs4 import BeautifulSoup
import urllib2
import datasets as dc
from wrappers import debug
from operator import itemgetter

def threeColumnString(line):
	"""
	Formats the table of values into 3 columns 
	"""
	colLengths = [[],[],[]]
	[[colLengths[i].append(len(cols[i])) for i in xrange(3)] for cols in line]
	maxLengths = [max(col) for col in colLengths]
	
	body = ["\t".join([(maxLengths[x] - len(cols[x])) * " " + cols[x] for x in xrange(3)]) for cols in line]
	return "\n".join(body[:-1]) + "\n\n" + body[-1]

def writeFeatureList(datafile):
	"""
	Function that creates a file that lists out all variable names 
	author: Jazmin @ JazminGonzalez-Rivero
	"""
	features = dc.getData(datafile)[0].keys()
	with open(config.path("..", "data", datafile, "features.py"), "wb") as f:
		f.write("features = [")
		for feature in features:
			f.write('"' + feature + '", ')
		f.write("]")

def writeChosenFeatures(datafile):
	"""
	Function that looks for CDF graphs remaining (ones that have not been deleted)

	author: chris
	"""
	with open(config.path("..","data",datafile,"chosen_features.py"), 'wb') as f:
		f.write("features = [")
		for dfile in config.os.listdir(config.path("..","visuals","feature_bin_costs",datafile)):
			f.write('"' + dfile[:-4] + '", ')
		f.write("]")


def getDetails(dataset, variable):
	"""
	Takes in the dataset filename and the variable name 
	Performs the HTTP GET Request and returns a list of decoded values
	"""

	url = "http://meps.ahrq.gov/data_stats/download_data_files_codebook.jsp?PUFId=%s&varName=%s" % (dataset, variable)
	page = urllib2.urlopen(url)
	soup = BeautifulSoup(page.read())
	details = []
	for line in soup.findAll('font', {'class':"smallBlack"}):
		details.append(line.text.encode('utf8').strip())
	return [("Title", "\n".join(details[:3])), ("Name", details[4]), ("Description", details[6]), ("Format", details[8]), ("Type", details[10]), ("Range", details[12] + "~" + details[14]), ("Values", threeColumnString([details[n:n+3] for n in xrange(15,len(details),3)]))]

def print_variable(decoded):
	"""
	Format prints decoded values for getDetails
	"""
	for head,body in decoded:
		print head
		print "================================================="
		print body
		print "\n"	
@debug
def writeFeatureImportance(model, trainFeature, datafile):
	"""
	Formats and prints the importance of each feature
	author: Jazmin 
	TODO: right now it gets the actual name of the features in a HORRIBLE NOT EFFICIENT WAY make it better
	"""
	importances = zip(range(trainFeature.shape[1]), model.feature_importances_)
	importances.sort(key = itemgetter(1))
	with open(config.path("..", "data", datafile, "featureImportance.py"), "wb") as f:
		f.write("importance = ")
		for featureIndex,importance in importances[::-1]:
			variable = config.feature_dict["H147"][featureIndex]
			f.write(" " + str(variable) + " " + str(importance) + " " + str(dc.getData(datafile)[0][variable][0]) + " \n")


if __name__ == "__main__":
	datafile = "H147"
	writeFeatureList(datafile)
	writeChosenFeatures(datafile)
	# features = ["IPFMCD11", "OPANO11", "OPBNO11", "PBPWKT42", "MCARE11X", "RXOTH11", "DAPID42X", "CDIAG53", "DSCONF53", "DVORTH11", "PNGJU11", "ZIDMCR11", "CAPANCRS", "FAMWT11C", "INS53X", "FAMWT11F", "OPSVA11", "HHAPTR11", "MCAID11", "ASSTIL31", "ACTLIM53", "CNGLDL53", "ZIFMCD11", "SELFCM42", "SCLNBD53", "JTPAIN53", "AMCOPU11", "PUBAT31X", "DVTOPU11", "OBESLF11", "ZIDOSR11", "OPTOPR11", "OFREMP31", "OBTOFD11", "DUPERSID", "SPOUID11", "HPROC11", "CERVREMS", "OBNSTL11", "HPODE11", "PDKMY11", "OBNMCD11", "HPNDE11", "AMNMCD11", "VISOFD11", "PRIDE11", "PUBJA11X", "INSAU11X", "CHGJ3142", "MCDAT31X", "DVTOFD11", "STJBDD31", "INTVLANG", "OPTOFD11", "DSPRX53", "OPPSTL11", "MESBPR42", "TOTSTL11", "HIEUIDX", "IADL3M31", "REFIMP11", "HHNOFD11", "HPDJL11", "DNTINS11", "ERFTRI11", "BONEREMS", "IPFEXP11", "BSNTY42", "MCDSE11", "SAQWT11F", "ADLANG42", "CNGFOG53", "PBINFT42", "OPFOFD11", "ZIDOPR11", "POUNO11", "STOMAGED", "VISPRV11", "ZIFOFD11", "DIABDX", "INSSE11X", "NWK42", "ELGRND42", "OPVWCP11", "ADRTCR42", "HHNMCD11", "CHHECR42", "OPBMY11", "PEGAP11", "NUMEMP42", "ZIFWCP11", "UNION42", "ADHDADDX", "MCDMC42", "VETSP11X", "DISVW53X", "TRICR11X", "PUBOC11X", "PRIVAT31", "MNHLTH53", "NHRWG31", "WHNLAP42", "OPDPRV11", "PRSMY11", "ADHOPE42", "DVOTCH11", "TOTOTH11", "CFMEM53", "CEFBCK53", "WHNWGT42", "ERDOTH11", "CHPRTM42", "TRICH42X", "HIDEG", "DSVB1053", "OBVEXP11", "OBOSLF11", "OBDOPU11", "HOUR42", "CDRET53", "PSTATS53", "DDNWRK42", "FILEDR11", "MOUTAGED", "HPRJL11", "STANO11", "DSFLNV53", "MCRSE11X", "PRVEV11", "AMAOFD11", "CWRKEF53", "OBVTRI11", "UNABLE31", "HSELIM53", "ENDRFM42", "PRSJA11", "HHAOFD11", "DDBDYS53", "RNDFLG31", "ONJOB42", "WCPIMP11", "CEXTMT53", "CEFPOS53", "FILER11", "OBAMCR11", "ENDRFD11", "CMMAIN53", "AMEVA11", "NOINUNIT", "LYMPAGED", "FAMINC11", "OBCVA11", "RXOSR11", "HPESE11", "CFMPOG53", "OBCEXP11", "HPDOC11", "SOCLIM53", "DSCPCP53", "KIDNAGED", "HRHOW31", "WHNDEN42", "ENGSPK42", "OTPUBB31", "NOSMOK42", "IPDOPU11", "OBNPRV11", "VISMCD11", "CEFHLT53", "OPTOTV11", "ZIDEXP11", "PDKSE11", "MOMPRO42", "IADLHP31", "PRIOG11", "CEXTM53", "LANGPR42", "OTPAAT31", "AMNURS11", "HPDSE11", "STOMCH53", "CSLHIN53", "CINDND53", "DSINSU53", "OBCSLF11", "CFMFTP53", "AGELAST", "SIBPRO42", "BRSTEX53", "OPOWCP11", "CNGFLT53", "COLOREMS", "MCDMY11", "CNGFXL53", "INSAT11X", "IPDPTR11", "OBOPRV11", "PMEDUP31", "ADCLIM42", "AMNOSR11", "MARRY11X", "PEGFE11", "TRIMA11X", "IPTOPR11", "POGMA11", "AMEPTR11", "OFFER42X", "HPOMY11", "CNPTOT53", "OBDTCH11", "OBTOTH11", "AMAMCR11", "BPCHEK53", "HHASLF11", "DSCGRP53", "BSNTY53", "POUJL11", "ZIFTCH11", "PAYDR42", "HPNAP11", "CNGLDT53", "SSIDIS11", "CHSPEC42", "ESPHREMS", "CTMOFF53", "NWK53", "DVTEXP11", "ADCMPD42", "ELGRND53", "PROUT42", "OBASST11", "JNTPID11", "TRIEV11", "DVOOPU11", "UNION31", "ERDTCH11", "OBAOPR11", "LAPBLT42", "AMCPTR11", "CHOIC42", "MDDLPR42", "ACTDTY31", "HPEMY11", "OPVOTH11", "MNHLTH42", "HIBPDX", "OBOSTL11", "AIDHLP31", "WHNHGT42", "CHILCR42", "CAESOPH", "AMNTCH11", "BSTST53", "MCRFE11", "RESPCT42", "OBDOFD11", "CPROM53", "CFNDBT53", "IPTSLF11", "RXMCD11", "HPEDE11", "OBCMCD11", "KIDNREMS", "SKDKREMS", "DDNWRK53", "HOUR53", "POGNO11", "PSTATS42", "OFFHOU42", "HPNJA11", "ADINSB42", "PUBJU11X", "PMDINS31", "DSFL1053", "OBOTRI11", "DVTMCR11", "IPFPTR11", "ADNDCR42", "AGE11X", "OBVOPU11", "PAYVAC31", "CEXTOG53", "ENDRFM53", "ADEXPL42", "INTIMP11", "OBEOFD11", "HELD53X", "UNEIMP11", "AMCVA11", "AMAEXP11", "HPSAU11", "CNGLDD53", "MCARE11", "OBEMCR11", "PUB53X", "PRIEU53", "ERFMCD11", "ASEVFL53", "HRHOW42", "COLOAGED", "CLDJOB53", "ERTMCR11", "POUMY11", "IPFMCR11", "OPDWCP11", "PRVHMO11", "OPDSTL11", "RACEAX", "DKWHRU42", "FTSTU31X", "ADPAIN42", "OPTSLF11", "CEFACT53", "RACEWX", "TRIAP11X", "VISOTH11", "EATHLT42", "TOTOPU11", "SCLNBD31", "CSAQW11F", "PRING11", "WAGIMP11", "HRWG53X", "MOPID42X", "MCDJL11X", "OFREMP53", "OBDPTR11", "OTHSTL11", "DVGOSR11", "ASPKFL53", "PEGNO11", "ADWRTH42", "STAMA11", "HPOSE11", "OPAFE11", "MESVIS42", "OPDTCH11", "MCDAT11X", "PRISE11", "ERTOPR11", "OTHDYS42", "AMCWCP11", "BEGRFM31", "HPRAU11", "OPPPRV11", "ERDOPU11", "OPAJU11", "COVRYY", "PDKMA11", "AMCOSR11", "AMCMCR11", "CSTSVM42", "MCARE31X", "ADLIST42", "PNGSE11", "AMTOTH11", "VISION42", "HEARNG42", "UNEMP11X", "ADPALS42", "HPDDE11", "DIABW11F", "DVTSTL11", "DSCHNV53", "KEYNESS", "MCRJU11", "TRICR53X", "PHMONP42", "PAYDR53", "RXWCP11", "OPVSLF11", "AFDC11", "WASMCAID", "PROUT53", "CINCOV53", "OTPAAT53", "LRNXREMS", "OPPTRI11", "OBAPRV11", "PREGNT31", "OTHSLF11", "LRNXAGED", "OPPOPU11", "OBTMCR11", "TEMPJB53", "OBAEXP11", "CHOIC53", "CHPMHB42", "OBDSLF11", "AMTSLF11", "THRTAGED", "SAFEST42", "HPDAP11", "DUID", "HPSOC11", "TMTKUS42", "STPRAT11", "CERVAGED", "ERFOPR11", "BLIND42", "MORE31", "OBTTCH11", "AMTEXP11", "TRIJL11X", "ARTHAGED", "AMEOPR11", "DVGVA11", "WASMCARE", "PNGMY11", "DVTTRI11", "AMNMCR11", "AMESLF11", "PMNCNP31", "BLODREMS", "DVOMCD11", "RECTREMS", "HISPCAT", "DSFTNV53", "POUJA11", "OPPVA11", "HEARSM42", "PAYVAC42", "OPBOC11", "INSAP11X", "OPSWCP11", "CMNPLC53", "DVGOPR11", "HPNOC11", "HPEMA11", "IPFOSR11", "TRIST11X", "AMNEXP11", "RACEX", "CFMGRT53", "TRIAT11X", "PUBAU11X", "REFPRS42", "DSEY1153", "PRIEU42", "OPTPTR11", "PRSOC11", "PSA53", "CEFCOP53", "DVOVA11", "HRHOW53", "GENDRP42", "HPSJA11", "HPOJA11", "WAGEP11X", "OTHPRV11", "WHNBPR42", "CACOLON", "IPTPTR11", "OTPUBB53", "OBEEXP11", "HPENO11", "APRTRM42", "REFFRL42", "MCAID42", "OTPBAT11", "CHLIST42", "CWYASK53", "HONRDC42", "CTRTMT53", "MCAID31", "OFREMP42", "CNGFTR53", "POUSE11", "OPSOSR11", "HPRDE11", "MCAID42X", "ERDOPR11", "MCRPD11X", "ADDRBP42", "DSFB1053", "OPBEV11", "MCRAU11", "RULETR11", "LUNGAGED", "HHAVA11", "AMTPRV11", "BEGRFD31", "CFMETM53", "ADNRGY42", "AMOPTO11", "IPDIS11", "OPSOFD11", "ERFOFD11", "OBTPTR11", "PRSJL11", "HPDJA11", "RXPTR11", "ZIFEXP11", "OPOMCR11", "OPOOPU11", "CCLHIN53", "ERTPTR11", "ADRISK42", "OPOPRV11", "OPOVA11", "ADDOWN42", "DSFT1053", "PEGJL11", "VISEXP11", "OPVPRV11", "HPEOC11", "AMAOSR11", "PRIS31", "OFFER53X", "OPBDE11", "MCDHMO11", "PMUNRS42", "HPOMA11", "AMCTRI11", "OBDSTL11", "HPDMY11", "DVTPRV11", "OPOOTH11", "BRSTREMS", "MCDMA11", "OTPAAT42", "ASATAK31", "MESHGT42", "DVGTRI11", "TRIMY11X", "DVTWCP11", "ADFHLP42", "HPRMY11", "PHYEXE53", "MORECOVR", "PREGNT42", "PRSDE11", "HHAOPU11", "PRIJL11", "ERTOTH11", "DDNSCL42", "CHPMCN42", "CHPMED42", "DECIDE42", "OBDOSR11", "CNPTDI53", "POGSE11", "TRIDE11X", "POUDE11", "OBAWCP11", "HSPLAP42", "ACTDTY42", "HRWGIM42", "OTHOSR11", "WHNSMK42", "ADFFRM42", "OTHNDD53", "ZIFMCR11", "NOINSBEF", "OBTVA11", "INSMA11X", "LYMPREMS", "OBOOPR11", "GDCPBM42", "HOUR31", "SKNMAGED", "TOTTCH11", "CATESTIS", "STRKDX", "CFMPTM53", "REGION11", "PMDINS11", "OPOSTL11", "OPTWCP11", "PAYVAC53", "IPDSLF11", "TRILI42X", "PAPSMR53", "ERDPRV11", "OTPUBA11", "PUB42X", "MCRMA11X", "HPNNO11", "MCS42", "DVTOT11", "OBEPRV11", "AGE31X", "REFPRS53", "PRIEU31", "HPOAU11", "STRKAGED", "OPBJA11", "MCRJL11", "DIFFWG53", "PRVHMO31", "INSFE11X", "CHTHCO42", "AMNPRV11", "MCRJU11X", "ADSOCA42", "MCRJA11X", "AMATCH11", "INDCAT31", "COVRMM", "DFTOUS42", "INSCOP53", "MCAID53", "ZIDMCD11", "OBVVA11", "CABREAST", "IPFSTL11", "BMINDX53", "OBCTRI11", "HONRDC53", "CFTTOT53", "AMEOPU11", "ASIANP42", "OBETRI11", "FTSTU42X", "ERTEXP11", "CHTHHB42", "MCRPB11", "LFTDIF31", "PEGDE11", "CLPROD53", "BLDRREMS", "FTSTU11X", "OPFPRV11", "OPOTCH11", "TRBLE42", "SPOUIN11", "POUMA11", "CFMUOG53", "ERFWCP11", "SEEDIF42", "CHOLAGED", "PUBP11X", "MCROC11", "OPFSTL11", "ASPRIN53", "AMTOPU11", "HPRSE11", "ADSPRF42", "ASMRCN53", "PRSAP11", "OPVOPU11", "MCRAP11", "DEDUCT11", "DSFT1153", "DVTVA11", "CMNLNG53", "INSCOV11", "HHNSTL11", "OBEMCD11", "USCNOT42", "PNGNO11", "IPZERO11", "CABONE", "IPDSTL11", "SICPAY31", "CABLOOD", "ADDPRS42", "IADL3M53", "DDNSCL53", "CHLIMI42", "PEGJA11", "OBNMCR11", "HPEAP11", "OBVPTR11", "CHLICO42", "PACISP42", "PRING31", "INSJA11X", "CPTASK53", "PANEL", "OBCPRV11", "DSEB1053", "INSENDYY", "OBVOSR11", "STPRAT31", "HRWGIM53", "OPFOPU11", "AMAOTH11", "INSC1231", "HHAPRV11", "TOTOFD11", "ERTVA11", "OTHNDD42", "TRIEX11X", "PEGMY11", "MUSCREMS", "ADEGMC42", "YCHJ4253", "LANGHM42", "AMCEXP11", "PNGMA11", "HHINDD11", "OBNOTH11", "OVRYAGED", "SSIIMP11", "RTHLTH53", "PMNCNP11", "CAUTERUS", "BSTSRE53", "OVRYREMS", "ADMALS42", "HHASTL11", "CNPTRT53", "TOTOSR11", "NOFAT53", "OPVTRI11", "LSHLTH42", "CHDDX", "AMTTRI11", "DSCH1053", "DIVDP11X", "LSTETH53", "OBOOPU11", "AMNSTL11", "HPNSE11", "WASSTAT4", "CALARYNX", "WASSTAT2", "WASSTAT1", "INSCOPE", "OBEOPR11", "DSDIET53", "WLKDIF53", "IPFOPR11", "OBDWCP11", "MELAREMS", "SEX", "EMPST53", "ERDWCP11", "OPAAU11", "MCAID53X", "ERDTRI11", "OPVMCR11", "SSNLJB42", "CFMOTH53", "RUSIZE31", "THYRAGED", "DIFFWG42", "ADINTR42", "PHNREG42", "ERFOTH11", "PRVHMO42", "WHNPHY42", "PUBDE11X", "MCRPD42", "ERTTCH11", "CEFMTL53", "TRIST31X", "OBETCH11", "DIFFPL42", "OTPBAT31", "CSHIMP11", "PMDLAY42", "EDUCYR", "NOLIKE42", "PRIOG53", "MCDMC11", "HPOAP11", "AMTOPR11", "OBCSTL11", "MCRPD31X", "AMEOSR11", "DSA1C53", "POVCAT11", "PRIAP11", "CNGLDM53", "STAJU11", "STPDIF31", "PRSTREMS", "AMASTL11", "POGFE11", "RULETR31", "RACEBX", "EVRETIRE", "HPEJA11", "OBNOFD11", "ANGIAGED", "LUNGREMS", "MARRY42X", "MCDOC11", "ERDSTL11", "TRIAT53X", "SCHLIM31", "OPFMCR11", "CALUNG", "HPNMA11", "BPMLDX", "IPDOFD11", "HPSMY11", "MCDHMO31", "PHMONP31", "OPFOSR11", "YNOUSC42", "TOTVA11", "PMUNPR42", "PNGOC11", "STAAU11", "MILDIF31", "CALYMPH", "HPRAP11", "HPDMA11", "OBDVA11", "HPOJL11", "CEXTRT53", "SGMTRE53", "DIABAGED", "HYSTER53", "ADUPRO42", "PNGDE11", "CLNTST53", "VISVA11", "HPRJA11", "JTINRU11", "NHRWG42", "OPOOSR11", "PRIS11", "BRAIAGED", "PRINO11", "CHTHER42", "FCSZ1231", "VISOSR11", "OPVEXP11", "WKINBD31", "DENTAL42", "MORJOB42", "STPRAT42", "MSA53", "DVGEN11", "CMNAFF53", "ZIDTCH11", "OBVOFD11", "ADINSA42", "MCDJU11", "TOTMCR11", "PRING42", "WCMPP11X", "STOMREMS", "MCDDE11X", "OPDOFD11", "AMEOTH11", "TRISE11X", "HHAMCR11", "REGION31", "OBVTCH11", "OBTOPU11", "FOODMN11", "RETPLN31", "CBCKYR53", "HPRMA11", "AMTOSR11", "IRASP11X", "RXEXP11", "HHAOSR11", "IPDPRV11", "OPDSLF11", "OPSOTH11", "RTPLNM42", "YCHJ3142", "OPFSLF11", "RXTRI11", "CEFOPN53", "AMCMCD11", "EMPST42", "CNPOG53", "CEFREC53", "PMDLPR42", "AMCSLF11", "MCRAP11X", "SSNLJB53", "DNDLAY42", "PRIVAT11", "OBCMCR11", "OPTTCH11", "DIVIMP11", "OBNOPU11", "PEGMA11", "HEALTH42", "AMNOFD11", "PUBAP11X", "OBATRI11", "CFNBNK53", "OBVWCP11", "OPVVA11", "WHNBST42", "ENDRFM11", "POUOC11", "DVOTRI11", "IPFPRV11", "PRIOG42", "AMTWCP11", "UTERAGED", "ZIDSLF11", "INS31X", "MCRPB31", "CNPTMT53", "PENSP11X", "CSTSVT42", "DENTIN31", "MCRNO11X", "HPSSE11", "PRIEU11", "LFTDIF53", "POGJU11", "DVGMCR11", "VETIMP11", "PPRWKT42", "CWYCNG53", "HHAOTH11", "AMNOPU11", "ERFSLF11", "DEAF42", "SPOUIN31", "WRKLIM53", "MCDAT42X", "THRTREMS", "DPOTSD11", "ASSTIL53", "CMTASK53", "INSCOP31", "IPFTRI11", "PDKNO11", "HHNOTH11", "IPFOPU11", "OPDOSR11", "PRIAU11", "OPPOPR11", "MDDLAY42", "IPTOTH11", "RFREL11X", "MYSELF42", "HPEJU11", "INS42X", "AMAOPU11", "AMEEXP11", "OBEPTR11", "PNGAP11", "POGOC11", "MCDHMO42", "PNGJA11", "WASAFDC", "MCDJU11X", "IPDOPR11", "AMEWCP11", "CFMFTM53", "OBEVA11", "CARECO42", "AMATRI11", "AMAPRV11", "OTPAAT11", "ZIDTRI11", "DNUNRS42", "CHLIHB42", "RECPEP42", "PCS42", "SAQELIG", "CFMFOG53", "CHLDP11X", "MCDMY11X", "NHRWG53", "LKINFT42", "CFNSAC53", "AMTHER11", "YNOINS42", "MCARE53X", "OPFEXP11", "AMCHIR11", "STPRAT53", "HRWGIM31", "DSFL1153", "MCDAP11X", "MCRFE11X", "MSA42", "OTHOTH11", "PRING53", "INSJU11X", "MCRJA11", "HHNSLF11", "HHNOPU11", "OCCCAT53", "AMTOTC11", "COGLIM53", "OBDTRI11", "STJBYY31", "PHYSCL42", "DEPDNT11", "PDKFE11", "RTHLTH31", "ONGONG42", "TOTEXP11", "CAPROSTA", "PRIV11", "DVGOTH11", "INTRP11X", "MCDAU11X", "FLUSHT53", "STAPR42", "OPTTRI11", "OCCCAT42", "AGE53X", "DVTOTH11", "OPDEXP11", "CABLADDR", "AMCSTL11", "OBTMCD11", "CALEUKEM", "CFMEXT53", "BLDRAGED", "OTHEXP11", "OPSSLF11", "ERTWCP11", "PPRWKM42", "OBNOPR11", "PMDLRS42", "OBOWCP11", "OBVMCD11", "OTHTCH11", "CEFOG53", "EXPLOP42", "LIVRAGED", "TRANS42", "DNUNAB42", "POGJL11", "INSAT42X", "FAMSZE11", "HPSMA11", "ARTHTYPE", "VISTCH11", "OPPTCH11", "PREVEN42", "INSENDMM", "WRKLIM31", "ADEZUN42", "HHAEXP11", "OPTSTL11", "AMCOPR11", "CACERVIX", "IPTTCH11", "CAMUSCLE", "WHNHEL42", "PUBAT11X", "HPSDE11", "FOODST11", "ZIDOTH11", "ESPHAGED", "OBVOPR11", "DVOEXP11", "CHNDCR42", "DVGPRV11", "OBTTRI11", "HPNMY11", "CMCEFF53", "MORE53", "FLSTAT11", "DVTOSR11", "CHILWW42", "OPPSLF11", "ZIDVA11", "DVOSLF11", "STPDIF53", "DVTTCH11", "OPBJL11", "CIN2OP53", "OBNWCP11", "CANCERDX", "OBCOFD11", "PMEDUP53", "REFDP11X", "HEARAD42", "OBAVA11", "SPOUIN42", "OPAJL11", "AMAOPR11", "ASACUT53", "OBOPTR11", "CNGFDI53", "HHNVA11", "DENTCK53", "MCAID11X", "IPDVA11", "CAMOUTH", "CAOVARY", "PRSAU11", "INSRPL42", "MUSCAGED", "PHMONP11", "HPONO11", "SICEAS42", "CARECTUM", "HHNOPR11", "NWK31", "OPFVA11", "VISPTR11", "MDUNAB42", "CASHP11X", "OBTOTV11", "BLODAGED", "MCDMC31", "CHLIMP11", "CHAPPT42", "IPTSTL11", "CASTOMCH", "MDUNPR42", "OPVOSR11", "OPPPTR11", "YNOINS53", "BSNTY31", "HPNJU11", "CLMHIP11", "OBDOPR11", "PHQ242", "MCROC11X", "PMEDPP42", "ERTTRI11", "CFMTOF53", "HPSAP11", "MSA31", "RUCLAS31", "ZIFPTR11", "LKINFM42", "MELAAGED", "PRSJU11", "RXVA11", "JOBORG53", "OTHDYS53", "STAPR53", "PRIVAT42", "SPRPRO42", "MCDOC11X", "BRAIREMS", "PRVMNC11", "HPOFE11", "TRIPR11X", "WILFIL11", "CLMDEP11", "PRIFE11", "OBCOPU11", "OBOTCH11", "OPTPRV11", "OBOOSR11", "DSCH1153", "DVOOSR11", "FAMRFPYR", "DSKIDN53", "DDNWRK31", "MORJOB31", "SFFLAG42", "REFPRS11", "HPNFE11", "KNOWDR42", "VISSTL11", "TRIJA11X", "CATHROAT", "OPOSLF11", "MCRPD31", "TOTTRI11", "PUBIMP11", "RXTOT11", "HRWG42X", "SKNMREMS", "OBTOSR11", "ENDRFM31", "MOPID53X", "INSNO11X", "ALIIMP11", "RUSIZE11", "LOCATN42", "CFMDRT53", "OTPUBA53", "AMTMCR11", "THYRREMS", "HPEFE11", "HRWG31X", "APRTRT42", "DVGPTR11", "BRSTAGED", "CHEXPL42", "PRIDK11", "MORE42", "CCNGFT53", "TOTMCD11", "ERFVA11", "ZIDWCP11", "HPDFE11", "CNGPOG53", "HPEJL11", "ERDMCD11", "OBDOTH11", "AMTSTL11", "CWRKP53", "COTARR53", "BEGRFD42", "PMEDUP42", "HPEAU11", "SPOUIN53", "AMTOFD11", "ERFOSR11", "LEUKAGED", "DSCINT53", "OPBAP11", "OBEWCP11", "MCDFE11", "DAPID53X", "ACTLIM31", "OTPUBA31", "WASCHAMP", "MCARE42X", "JTPAIN31", "OPSTRI11", "MCRMY11", "OPOEXP11", "OTHOPU11", "PAYDR31", "STAMY11", "ZIFOPU11", "UTERREMS", "POVLEV11", "OTHRP11X", "AGE42X", "NOINSTM", "CMNINS53", "CFMNTM53", "SSIP11X", "PEGOC11", "OBTSLF11", "INSCOP11", "OBVOTH11", "OPADE11", "CHOIC31", "OBOVA11", "DVOPTR11", "OBNVA11", "OPTOSR11", "AMTTCH11", "ZIDPTR11", "MCREV11", "CHOLDX", "OPOOPR11", "HEARMO42", "OBTWCP11", "OBAPTR11", "RTHLTH42", "AMCTCH11", "PRIS42", "MCDMA11X", "MNHLTH31", "PMEDPP53", "CHEMPB42", "UNHAP42", "PROXY31", "CBCK53", "DVOOPR11", "IPTPRV11", "OBAOPU11", "HHNWCP11", "COGLIM31", "OPSOPR11", "OPOTRI11", "PRDRNP31", "ADSAD42", "PBSVCT42", "ERTPRV11", "PRIV31", "TRICR42X", "EMPST31", "JOBORG42", "OBOOTH11", "IPFVA11", "STJBMM31", "PRIVAT53", "ZIFTRI11", "OTHINS42", "HSELIM31", "OPSOPU11", "FAMID31", "CHBRON53", "OPFMCD11", "CFNPMT53", "HHNTRI11", "OPOPTR11", "FAMID11", "OPFOPR11", "RFREL31X", "OBDMCR11", "FAMSZE31", "DVTMCD11", "DSFL1253", "AMTVA11", "PDKAU11", "PSTATS31", "PRVDRL31", "RESP11", "OBOTHV11", "DNDLPR42", "IPTOFD11", "CMNCRE53", "ADREST42", "TTLP11X", "DPINRU11", "PRSNO11", "ZIDSTL11", "AMAVA11", "CABRAIN", "ADSPEC42", "OTPUBA42", "RCHDIF31", "RTPLNT42", "MCRSE11", "DDBDYS31", "HHNEXP11", "AMASLF11", "FNGRDF53", "ASTHEP31", "AMNTRI11", "CAMELANO", "ERFSTL11", "OTHMCR11", "CEXTOT53", "FOODVL11", "TRICR31X", "NOASPR53", "DSEY1053", "WHNSAF42", "BEGRFD53", "SOCLIM31", "ERDPTR11", "OBOEXP11", "AMEMCD11", "OTHDYS31", "OPOOFD11", "OBCOPR11", "ZIFOPR11", "ADMWLM42", "CMNACC53", "STASE11", "OTHIMP11", "OBCTCH11", "CASKINNM", "SELFCM31", "HHAMCD11", "INSJL11X", "MCDEV11", "TRSTP11X", "PNGAU11", "IPTVA11", "AMNPTR11", "PERSLA42", "APRDLT42", "NUMEMP53", "CINREF53", "PBSVCM42", "SPOUID42", "POGAU11", "OBAMCD11", "TRIFE11X", "CEFLCT53", "BPMONT53", "ASTHDX", "CEXTLT53", "LIVRREMS", "OPVMCD11", "OTHOPR11", "DVGOPU11", "FNGRDF31", "OPTMCD11", "ELGRND31", "CATHYROD", "CLSTRT53", "PUBNO11X", "CHRTCR42", "PUB31X", "HHNPRV11", "OBCOSR11", "PNGJL11", "PRIS53", "CEFAHU53", "MSA11", "WASESTB", "TOTPRV11", "OTHOFD11", "DSDIA53", "CHENEC42", "DSMED53", "PROXY42", "OTHNDD31", "AMETRI11", "ADRTWW42", "RUCLAS11", "OPSMCD11", "TRICH11X", "PUBJL11X", "STJBYY42", "MIDX", "AMASST11", "HIBPAGED", "AMDRC11", "TRIAU11X", "ALIMP11X", "AMCPRV11", "ACCELI42", "DVGMCD11", "WLK3MO31", "NUMEMP31", "JOBORG31", "MINORP42", "OBVSTL11", "PUB11X", "STAAP11", "PID", "SSNLJB31", "OPPOFD11", "PDKJU11", "CEXTDI53", "STAJL11", "CELIGI53", "ENDRFY11", "STJBYY53", "CHSERV42", "AMNWCP11", "IRAIMP11", "AMNSLF11", "MCDNO11", "MCRMA11", "STNDIF53", "OBNPTR11", "MORJOB53", "OPAAP11", "FAMS1231", "DISVW31X", "FAMSZE42", "DIFFWG31", "CHBMIX42", "HPRNO11", "PDKAP11", "ZIFPRV11", "ADPWLM42", "OPBFE11", "CMCFUP53", "INDCAT53", "MCRPD11", "OPPOTH11", "PENIMP11", "PRVMNC31", "IPTMCR11", "CSHCN42", "OBASTL11", "CFRET53", "HONRDC31", "CNPTOF53", "TRIPR31X", "ERTSTL11", "CMCSTY53", "CEFASK53", "OBVPRV11", "PRSFE11", "MOPID31X", "OPTVA11", "REFPRS31", "PRIDK31", "RXOPU11", "OBNTRI11", "CNGPMT53", "READNW42", "OPPWCP11", "DSCNPC53", "BEGRFY31", "BLCKPR42", "OPAJA11", "TIMALN42", "FCRP1231", "TOTSLF11", "ERDVA11", "INSURC11", "CHRTWW42", "ASWNFL53", "IPTOSR11", "EICRDT11", "MCRPHO42", "CFNUNB53", "CMNOFF53", "OBDPRV11", "PMEDPY31", "IPTOPU11", "LEUKREMS", "OPPMCD11", "PMEDIN31", "HHNMCR11", "OBTEXP11", "SPOUID53", "TOTOPR11", "RFREL42X", "DVGTCH11", "POUJU11", "SGMTST53", "OHRTAGED", "ADCMPM42", "WRHLTH42", "DSEYNV53", "ASDALY53", "ADCMPY42", "ADGENH42", "AFTHOU42", "DDNSCL31", "PROUT31", "ERFPTR11", "BENDIF31", "BEGRFM53", "PLCTYP42", "CFREE53", "MCDFE11X", "DADPRO42", "ZIFSLF11", "CHSRHB42", "OTHRREMS", "PMEDPP31", "FSAAMT31", "CMNTIM53", "POGMY11", "MCDJA11X", "HPNAU11", "DVGOFD11", "PROXY53", "PRSTAGED", "AMNOTH11", "EVRWRK", "RXSLF11", "VARSTR", "ENDRFD31", "ERTSLF11", "IPDMCR11", "OBNEXP11", "PRDRNP11", "TEMPJB42", "NOHINS42", "HHAOPR11", "ERDSLF11", "DVOOFD11", "OBCHIR11", "ADL3MO31", "VISWCP11", "DVOSTL11", "AMEOFD11", "OTHREA42", "PRIV53", "PERWT11F", "IPFTCH11", "STJBMM53", "ENGCMF42", "UNINS11", "MESWGT42", "OBOMCR11", "OBAOFD11", "OPPEXP11", "CNGPLT53", "ARTHDX", "WHITPR42", "MCDJL11", "PRIOC11", "OBVSLF11", "RXPRV11", "ADHDAGED", "EVRUNAT", "ADRESP42", "SEATBE53", "CHBRON31", "RXSTL11", "CFM2MT53", "TRICH31X", "CFMLDJ53", "HLTHLF42", "HPOJU11", "DNUNPR42", "FAMSZE53", "CALIVER", "PRVDRL11", "AMEPRV11", "TEMPJB31", "PBPWKM42", "TOTWCP11", "CAKIDNEY", "OBNSLF11", "NEWARE42", "INDCAT42", "ERFPRV11", "IPDTCH11", "MCRMY11X", "PRVMNC42", "TRIST42X", "OPSTCH11", "RCHDIF53", "CHRESP42", "MCRDE11", "CEFSTG53", "MCDAU11", "DENTIN42", "HASFSA31", "MARRY53X", "RXOPR11", "MCRPD42X", "ASTHEP53", "ADDAYA42", "EMPHAGED", "IPTWCP11", "OPFTCH11", "RUCLAS53", "OPDMCD11", "PRIDK42", "MCARE42", "ENDRFD53", "IPNGTD11", "IPDTRI11", "VISOPR11", "WASOTGOV", "WRGLAS42", "AMAWCP11", "OPBAU11", "OBVMCR11", "USBORN42", "TOTDED11", "OPDOPU11", "DOBYY", "OBCPTR11", "ERTOSR11", "OPOTHV11", "ADILCR42", "RUSIZE42", "CHSRCN42", "OPBSE11", "PROVTY42", "WASPRIV", "STADE11", "DVGSLF11", "MCRPHO31", "CNGPDI53", "EVRUNINS", "ZIDOFD11", "OBAOSR11", "WASSTAT3", "PRSSE11", "SCHLBH42", "PUBMY11X", "FSAGT31", "ERDEXP11", "WASSSI", "HISPANX", "RESP31", "AMESTL11", "DVTPTR11", "AMAPTR11", "DSEYPR53", "HELMET42", "OBNOSR11", "ELGRND11", "BOOST42", "OPDRV11", "ASATAK53", "RURSLT31", "DSCB1053", "NOREAS42", "BEGRFM42", "ADLHLP31", "IPDOTH11", "PRIMA11", "OBOOFD11", "EXRCIS53", "OPTOTH11", "AMTPTR11", "IADL3M42", "RESP42", "MCRDE11X", "ADSMOK42", "HPRFE11", "POGDE11", "HPSJU11", "ERTOT11", "OBNTCH11", "OPAMA11", "PBINFM42", "OPBJU11", "ADTLHW42", "GOTOUS42", "SKDKAGED", "PDKJA11", "MDUNRS42", "PROXY11", "CMCPSY53", "ADL3MO42", "CNGFLX53", "CPSFAMID", "OPTEXP11", "CNPTLT53", "PEGSE11", "DVOOTH11", "HPSFE11", "OPFTRI11", "SSECP11X", "AMEMCR11", "CHEYRE42", "PRIV42", "CPTTOT53", "OTHTRI11", "OCCCAT31", "STJBMM42", "CHCOUN42", "CHOLCK53", "ERDMCR11", "ERDOSR11", "K6SUM42", "TREATM42", "RXMCR11", "WKINBD53", "ENDRFY31", "ASTHAGED", "NOGODR42", "POUAU11", "TRILI11X", "OPDMCR11", "DVOPRV11", "WASVA", "ERTMCD11", "STNDIF31", "SALEP11X", "HAVEUS42", "OBCOTH11", "PANCREMS", "ADPRX42", "DSEY1253", "CCNGPT53", "CMOTHR", "WLKLIM31", "ADPRTM42", "ASPREV53", "MOUTREMS", "AMAMCD11", "OBDEXP11", "FTSTU53X", "PUBSE11X", "MCRNO11", "OPASE11", "IPFSLF11", "ZIDOPU11", "CEFRSP53", "CNGLDJ53", "MDDLRS42", "OPSSTL11", "IPDOSR11", "TRIAT31X", "VISOPU11", "APRDLM42", "INS11X", "PMUNAB42", "OHRTDX", "DENTIN53", "HELD31X", "TYPEPE42", "MCARE53", "FMRS1231", "OPDOPR11", "PNGFE11", "FAMSZEYR", "ENDRFD42", "ERFMCR11", "PRIDK53", "TSTSAGED", "HHNOSR11", "PDKOC11", "OBCWCP11", "RFREL53X", "TRIJU11X", "CTMSK53", "OPSMCR11", "ADINST42", "CCNRDI53", "HHATRI11", "CMCNEC53", "SELFCM53", "BEGRFY53", "INSCOP42", "DVGSTL11", "CLNTRE53", "DAPID31X", "OPDVA11", "MCDJA11", "INSMY11X", "CLHINS53", "VISTRI11", "OPDOTH11", "IPTTRI11", "OBOPTO11", "RUSIZE53", "OTHPTR11", "HPNJL11", "OTPBAT42", "SCHPRO42", "MCRAU11X", "VARPSU", "IADLHP42", "CNGFXM53", "PMEDPY53", "HPSJL11", "ZIFOTH11", "AMTMCD11", "PDKJL11", "OPFOTH11", "POGAP11", "DNDLRS42", "MCDAT53X", "POGJA11", "SPOUID31", "ADNERV42", "OPPMCR11", "OPDPTR11", "RULETR42", "OBASLF11", "PEGJU11", "MCDAP11", "SICPAY53", "JOBRSN42", "STJBDD53", "IPTMCD11", "RURSLT53", "BENDIF53", "OBEOSR11", "ADAPPT42", "ERDOFD11", "USLIVE42", "RESP53", "OBNURS11", "OTPUBB42", "OBOMCD11", "DNTINS31", "PMEDIN53", "HHTOTD11", "ANYLIM11", "CAOTHER", "OBTSTL11", "RUCLAS42", "DVOWCP11", "HHINFD11", "HHNTCH11", "DVOMCR11", "PROUT11", "CFMPTF53", "ADLHLP53", "ADL3MO53", "RETPLN53", "TRTIMP11", "CFNAMT53", "ZIFSTL11", "OPBMA11", "OBTOPR11", "SALIMP11", "PUBAT53X", "RURSLT42", "DVGEXP11", "OBESTL11", "HPDJU11", "NEVILL42", "VISMCR11", "OBDRV11", "NATAMP42", "WHNEAT42", "WKINBD42", "AMNVA11", "UNABLE53", "ENDRFY42", "STAJA11", "PRSMA11", "INSAT53X", "ERFEXP11", "HPSNO11", "BUSIMP11", "OPVTCH11", "DVTSLF11", "ERTOFD11", "BUSNP11X", "FAMID53", "HHATCH11", "GDCPBT42", "IPDWCP11", "HAVFUN42", "OBDMCD11", "OPAOC11", "HEARDI42", "ADCAPE42", "EDUYRDEG", "REGION42", "PANCAGED", "IPDEXP11", "CLINIC42", "OBTHER11", "OTPUBB11", "CNGPTR53", "MCDDE11", "MARRY31X", "POUFE11", "INSAT31X", "NERVAF42", "IPDMCD11", "ERFOPU11", "WLKDIF31", "TRINO11X", "ZIDPRV11", "OTHWCP11", "DSCH1253", "OPAEV11", "ADHECR42", "OPVOPR11", "PREGNT53", "OPSEXP11", "OBEOPU11", "HPDAU11", "OPVOFD11", "BEGRFY42", "CHDAGED", "HPRJU11", "MCDNO11X", "OPOMCD11", "OPFWCP11", "OPVPTR11", "POUAP11", "OTHVA11", "KIDPRO42", "TRIEX31X", "WLKLIM53", "OPTOPU11", "HPOOC11", "TRIAT42X", "PREVCOVR", "ZIFVA11", "PUBAT42X", "ADEFRT42", "OTPBAT53", "IADLHP53", "MCRPHO11", "PDKDE11", "OPPOSR11", "SCLNBD42", "PMEDPY42", "PRIOG31", "INSDE11X", "MCRPB42", "MCDSE11X", "OBAOTH11", "TRIEX42X", "WASOTHER", "DOBMM", "EMPHDX", "OPAMY11", "PUBFE11X", "MCAID31X", "PRIJU11", "RULETR53", "DVTOPR11", "OPVSTL11", "OPSPRV11", "HHAGD11", "AMCOFD11", "CERET53", "AMNOPR11", "OFFER31X", "ADOVER42", "SICPAY42", "MCRJL11X", "STJBDD42", "CASKINDK", "PUBMA11X", "YNOINS31", "SCHLIM53", "ADNSMK42", "PEGAU11", "CFTRT53", "DSCPHN53", "IPFOFD11", "OBEOTH11", "DSFT1253", "PMEDIN42", "AMCOTH11", "EDRECODE", "ADILWW42", "CNGFXT53", "HOMEBH42", "SELDSI42", "CNGFMT53", "PRIMY11", "TAXFRM11", "OBATCH11", "ERTOPU11", "DVGWCP11", "PRIJA11", "PRDRNP42", "HHAWCP11", "OBTPRV11", "RXOFD11", "SSCIMP11", "MAMOGR53", "MILDIF53", "ADLHLP42", "UNION53", "CFMNPT53", "INSOC11X", "CEFRHU53", "ERFTCH11", "NEWDOC42", "STAPR31", "TSTSREMS", "HPDNO11", "CHECK53", "DISVW42X", "TRILI31X", "MIAGED", "OTHMCD11", "IPTEXP11", "ACTDTY53", "IPFOTH11", "OTHRCP42", "AIDHLP53", "RECTAGED", "OPFPTR11", "ENDRFY53", "OPSPTR11", "OTHRAGED", "DOCELS42", "WLK3MO53", "BONEAGED", "HHNPTR11", "STAPR11", "FAMIDYR", "ZIFOSR11", "TRIOC11X", "FAMID42", "RETPLN42", "TRIPR42X", "CFMCOG53", "PRVDRL42", "RACETHNX", "STAOC11", "PMNCNP42", "IPFWCP11", "ANGIDX", "CHGJ4253", "HELD42X", "REGION53", "VISSLF11", "OPTMCR11", "DDBDYS42", "STAFE11", "CNGFXD53", "OPDTRI11", "MCARE31", "TOTPTR11", "CNGLOG53", "AMETCH11"]
	# for feature in features:
	# 	print_variable(getDetails("H147", feature))
	# 	if raw_input() == "x":
	# 		want.append(feature)
